<html>
    <head th:replace="/fragments/head :: head"> </head>
    <body class="text-gray-800 antialiased">
        <header class="navcolor">
            <nav th:replace="/fragments/navbar :: nav">  </nav>
        </header>
        <main class="profile-page">
            <section class="relative block" style="height: 320px;">
                <div
                    class="absolute top-0 w-full h-full bg-center bg-cover"
                    style='background-image: url("https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSybB6X0tjnGJa0GDIVovhBm4qeSFzAcgV9hPeRW4GEldCAie2SS3bcpE5cYEPtZ5TZAsI&usqp=CAU");'
                    >

                    <span
                        id="blackOverlay"
                        class="w-full h-full absolute"
                        ></span>
                </div>
                <div
                    class="top-auto bottom-0 left-0 right-0 w-full absolute pointer-events-none overflow-hidden"
                    style="height: 70px;"
                    >
                    <svg
                        class="absolute bottom-0 overflow-hidden"
                        xmlns="http://www.w3.org/2000/svg"
                        preserveAspectRatio="none"
                        version="1.1"
                        viewBox="0 0 2560 100"
                        x="0"
                        y="0"
                        >
                        <polygon
                            class="text-gray-300 fill-current"
                            points="2560 0 2560 100 0 100"
                            ></polygon>
                    </svg>
                </div>
            </section>
            <section class="relative py-16 bg-gray-300" th:if="${session.usersession!=null}">
                <div class="container mx-auto px-4">
                    <div class="relative flex flex-col min-w-0 break-words bg-white w-full mb-6 shadow-xl rounded-lg -mt-64">
                        <div class="px-6">
                            <div class="flex flex-wrap justify-center">
                                <div class="w-full lg:w-3/12 px-4 lg:order-2 flex justify-center">
                                    <div class="relative"> 
                                        <img id="fotoPerfil" th:src="@{/imagen/perfil/__${user.id}__}"  class="shadow-xl w-90 h-40 bg-gray-100 rounded-full align-middle border-none absolute -m-16 -ml-20 lg:-ml-16"
                                             style="max-width: 150px;">
                                    </div>
                                </div>

                                <div class="  w-full lg:w-4/12 px-4 lg:order-3 lg:text-right lg:self-center">
                                    <div class=" py-6 px-3 mt-32 sm:mt-0">
                                        <div >
                                            <button
                                                class="bg-green-600 active:bg-pink-600 uppercase text-white font-bold hover:shadow-md shadow text-xs px-4 py-2 rounded outline-none focus:outline-none sm:mr-2 mb-1"
                                                type="button"
                                                style="transition: all 0.15s ease 0s;"
                                                id="contactar"
                                                >
                                                Solicitar Servicio

                                            </button>
                                            <div id="menuContactar" class="hidden">
                                            <div id="" class="absolute right-0 mt-3 w-96 max-w-md rounded-3xl bg-white shadow-lg ring-1 ring-gray-900/5">
                                                <div class="p-4" >
                                                    <form th:action="@{/trabajos/crearTrabajo}" method="POST" id="solicitarTrabajo">
                                                        <input type="hidden" id="idU" name="idU" th:value="${session.usersession.id}">
                                                            <input type="hidden" id="idP" name="idP" th:value="${user.id}">
                                                                <div class="mb-3">
                                                                    <label for="descripcion" class="block text-sm font-medium text-gray-700">¿Qué puedo hacer por ti?</label>
                                                                    <textarea class="w-full h-24 border rounded-lg px-3 py-2 text-sm text-gray-700 placeholder-gray-400 focus:outline-none focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" id="descripcion" name="descripcion" placeholder="Ingresa la descripción del servicio" required></textarea>
                                                                </div>
                                                                <button class="bg-green-600 active:bg-pink-600 text-white font-bold hover:shadow-md shadow text-xs px-4 py-2 rounded outline-none focus:outline-none" type="submit">
                                                                    ENVIAR
                                                                </button>
                                                                </form>
                                                                </div>
                                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full lg:w-4/12 px-4 lg:order-1">
                                    <div class="flex justify-center py-4 lg:pt-4 pt-8">
                                        <div class="mr-4 p-3 text-center">
                                            <span
                                                class="text-xl font-bold block uppercase tracking-wide text-gray-700" th:text="${trabajos.size}"
                                                ></span>
                                            <p ><span class="text-sm text-gray-500">Trabajos Contratados</span></p>
                                        </div>
                                    
                                    <div th:if="${#strings.equalsIgnoreCase(session.usersession.rol, 'PROVEEDOR')}" class="mr-4 p-3 text-center">
                                            <div th:each="trabajo : ${trabajos}">
                                                <div th:if="${trabajo.calificacion.puntuacion!=0.0}" class="trabajo-calificado">
                                                   
                                                </div>
                                            </div>
                                            <span
                                                id="contadorTrabajosConCalificacion" class="text-xl font-bold block uppercase tracking-wide text-gray-700"
                                                ></span>
                                            <a href="#" class="hover:underline hover:text-gray-500"><span class="text-sm text-gray-500">Calificaciones</span></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="text-center mt-12">
                                <div class="text-2xl font-semibold leading-normal mb-2 text-gray-800 mb-2">
                                    <div class="flex justify-center">
                                        <p  id="puntuacion" th:text="${user.puntuacion}" class="hidden"></p>
                                        <ul id="estrellasPerfil" ></ul>
                                    </div>

                                    <h3
                                        class="text-4xl font-semibold leading-normal mb-2 text-gray-800 mb-2"
                                        th:text="${user.nombre}">
                                    </h3>
                                </div>
                                <div class="mb-2 text-gray-700">
                                    <i class="fas fa-phone mr-2 text-lg text-gray-500"></i
                                    ><p th:text="${user.telefono}"> </p>
                                </div>
                                <div>
                                    <div  class="mb-2 text-gray-700 mt-4">

                                        <i class="fas fa-briefcase mr-2 text-lg text-gray-500"></i
                                        ><p th:if="${#strings.equalsIgnoreCase(user.rol, 'PROVEEDOR')}" th:text="${user.especialidad.nombre}"></p>
                                    </div>
                                    <div class="mt-10 py-10 border-t border-gray-300 text-center">
                                        <div class="flex flex-wrap justify-center">
                                            <div class="w-full lg:w-9/12 px-4 flex flex-col items-center">
                                                <p class="mb-4 text-lg leading-relaxed text-gray-800" th:text="${user.descripcion}"></p>
                                                <div class="flex flex-col items-center">
                                                    <p th:if="${#strings.equalsIgnoreCase(user.rol, 'PROVEEDOR')}" th:text=" 'Costo Hora $' +${user.costoHora}"class="bg-blue-950 uppercase text-white font-bold hover:shadow-md shadow text-xs px-4 py-2 rounded outline-none focus:outline-none sm:mr-2 mb-1 w-max">
                                                    </p>
                                                </div>
                                            </div>                  
                                        </div>
                                        <div class="min-h-min flex items-stretch justify-center ">
                                            <div class=" ">
                                                <table th:if="${trabajos.size!=0}" class="w-auto divide-y divide-gray-200 rounded-md mx-4 my-4 shadow-md rounded-lg">
                                                    <caption class="caption-top">
                                                        TRABAJOS REALIZADOS POR ESTE PROVEEDOR
                                                    </caption>
                                                    <div >
                                                        <thead>
                                                            <tr>
                                                                <th scope="col" class="hidden">ID</th>
                                                                <th class="px-6 py-3 bg-blue-100 text-center text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider text-center" scope="col">FECHA</th>
                                                                <th class="px-6 py-3 bg-blue-100 text-center text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider text-center" scope="col">COMENTARIO</th>
                                                                <th class="px-6 py-3 bg-blue-100 text-center text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider text-center" scope="col">PUNTUACIÓN</th>
                                                                <th class="px-6 py-3 bg-blue-100 text-center text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider text-center" scope="col">ESTADO</th>

                                                            </tr>
                                                        </thead>
                                                        <tbody class="bg-blue-50 divide-y divide-gray-200" th:each="trabajo : ${trabajos}" th:if="${#strings.equalsIgnoreCase(trabajo.estado, 'FINALIZADO')}">
                                                            
                                                            <tr>

                                                                <td class="font-thin px-6 py-4 whitespace-no-wrap"  >12/12/12</td><!-- th:text="${trabajo.calificacion.fecha}" -->
                                                                <td class="font-thin px-6 py-4 whitespace-no-wrap" th:if="${trabajo.calificacion.contenido==null}"> Sin Calificación</td>
                                                                <td class="font-thin px-6 py-4 whitespace-no-wrap" th:if="${trabajo.calificacion.contenido!=null}" th:text="${trabajo.calificacion.contenido}"></td>
                                                                <td class="font-thin px-6 py-4 whitespace-no-wrap text-center" th:if="${trabajo.calificacion.puntuacion==0.0}">Sin Calificación </td>
                                                                <td class="font-thin px-6 py-4 whitespace-no-wrap text-center" th:if="${trabajo.calificacion.puntuacion!=0.0}"th:text="${trabajo.calificacion.puntuacion}"></td>
                                                                <td class="px-6 py-4 whitespace-no-wrap " scope="row" th:text="${trabajo.estado}" ></td>


                                                            </tr>

                                                        </tbody>
                                                    </div>
                                                </table>
                                            </div>
                                        </div>

                                    </div>
                                </div> 
                            </div>
                        </div>
                    </div>
                </div>

            </section>

        </main>
        <footer th:replace="/fragments/footer :: footer">  </footer>
        <script  src="/index.js"></script>
    </body>
</html>
